(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{C8:()=>A,bh:()=>T,TD:()=>z});var t=function(e){e.classList.remove("popup_opened")},o=function(e){e.classList.add("popup_opened")};function r(e){T.src=e.target.closest(".photo-grid__item-image").src,z.textContent=e.target.closest(".photo-grid__item").querySelector(".photo-grid__title").textContent,o(A)}var n="https://nomoreparties.co/v1/wbf-cohort-4",c=function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))};function a(e){var t;t=e.target.closest(".photo-grid__item").querySelector(".photo-grid__item-image").id,fetch("".concat(n,"/cards/").concat(t),{method:"DELETE",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a"}}).then(c),e.target.closest(".photo-grid__item").remove()}function i(e){var t,o=e.target.closest(".photo-grid__item").querySelector(".photo-grid__item-image").id,r=e.target.closest(".photo-grid__like-button").classList.toggle("photo-grid__like-button_liked"),a=e.target.closest(".photo-grid__like-area").querySelector(".photo-grid__liked-count");r?(t=o,fetch("".concat(n,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a"}}).then(c),a.textContent=Number(a.textContent)+1):(function(e){fetch("".concat(n,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a"}}).then(c)}(o),a.textContent=Number(a.textContent)-1)}var u=function(e,t,o,n,c){var u=c.cloneNode(!0);return u.querySelector(".photo-grid__item-image").src=e,u.querySelector(".photo-grid__item-image").id=o,u.querySelector(".photo-grid__title").textContent=t,u.querySelector(".photo-grid__liked-count").textContent=n,u.querySelector(".photo-grid__delete-button").addEventListener("click",a),u.querySelector(".photo-grid__item-image").addEventListener("click",r),u.querySelector(".photo-grid__like-button").addEventListener("click",i),u},s=function(e){e.querySelector(".popup__form").reset(),Array.from(e.querySelectorAll(".popup__input_type_error")).forEach((function(t){t.classList.remove("popup__input_type_error"),e.querySelector("#".concat(t.id,"-error")).textContent=""}));var t=e.querySelector(".popup__button");t.disabled=!0,t.classList.add("popup__button_disabled")},p=function(e,o){"Escape"!=e.key&&"Esc"!=e.key||t(o)},l=function(e){return e.querySelector(".popup__button").textContent="Сохранение..."},d=function(e){return e.querySelector(".popup__button").textContent="Сохранить"},_=document.querySelector(".profile__title"),f=document.querySelector(".profile__subtitle"),m=document.querySelector(".profile__avatar"),h=function(){fetch("".concat(n,"/users/me"),{headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a"}}).then(c).then((function(e){_.textContent=e.name,f.textContent=e.about,m.src=e.avatar})).catch((function(e){_.textContent="",f.textContent="",m.src="#",console.log(e)}))},b=document.forms.profileform,v=document.forms.avatarform,y=b.elements.nameinput,S=b.elements.aboutinput,g=v.elements.avatarlink,q=document.querySelector(".profile__edit-button"),C=document.querySelector(".popup__profile"),L=document.querySelector(".popup__edit-avatar"),E=document.querySelector(".profile__avatar"),k=document.querySelector(".profile__add-button"),x=document.querySelector(".popup__add-card"),T=document.querySelector(".popup__picture"),z=document.querySelector(".popup__picture-title"),A=document.querySelector(".popup__place-picture"),j=document.querySelector(".photo-grid"),O=document.querySelector("#grid-item").content.querySelector(".photo-grid__item");h(),fetch("".concat(n,"/cards"),{headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a"}}).then(c).then((function(e){var t,o;t=j,o=O,e.forEach((function(e){var r=u(e.link,e.name,e._id,e.likes.length,o);"fb4f164cb7425743afcd59f4"!==e.owner._id&&r.querySelector(".photo-grid__delete-area").classList.add("photo-grid__delete-area_hidden"),t.append(r)}))})),q.addEventListener("click",(function(){s(C),o(C),y.value=_.textContent,S.value=f.textContent})),E.addEventListener("click",(function(){s(L),o(L),g.value=E.src})),v.addEventListener("submit",(function(e){var o;e.preventDefault(),l(v),o=g.value,fetch("".concat(n,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a","Content-Type":"application/json"},body:JSON.stringify({avatar:o})}).then(c),h(),d(v),t(v.closest(".popup"))})),b.addEventListener("submit",(function(e){var o,r;e.preventDefault(),l(b),o=y.value,r=S.value,fetch("".concat(n,"/users/me"),{method:"PATCH",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a","Content-Type":"application/json"},body:JSON.stringify({name:o,about:r})}).then(c),h(),d(b),t(b.closest(".popup"))})),k.addEventListener("click",(function(){s(x),o(x)}));var P,D,N=document.forms.cardform,w=N.elements.placelink,B=N.elements.placeinput;N.addEventListener("submit",(function(e){var o,r;l(N),(o=B.value,r=w.value,fetch("".concat(n,"/cards"),{method:"POST",headers:{authorization:"b976a8cc-ba22-46b5-85e7-81e7fb97574a","Content-Type":"application/json"},body:JSON.stringify({name:o,link:r})}).then(c)).then((function(e){j.prepend(u(e.link,e.name,e._id,0,O))})),d(N),t(N.closest(".popup")),N.reset(),e.preventDefault()})),document.addEventListener("click",(function(e){(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-button"))&&t(e.target.closest(".popup"))})),document.addEventListener("keydown",(function(e){var t=document.querySelector(".popup_opened");return t&&p(e,t),document.removeEventListener("keydown",(function(e){var t=document.querySelector(".popup_opened");t&&p(e,t)}))})),D=(P={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}).formSelector,Array.from(document.querySelectorAll(D)).forEach((function(e){!function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);o.forEach((function(n){n.addEventListener("input",(function(){!function(e,t,o){t.validity.valid?function(e,t,o){var r=e.querySelector("#".concat(t.id,"-error"));t.classList.remove(o.inputErrorClass),r.classList.remove(o.errorClass),r.textContent=""}(e,t,o):function(e,t,o){var r=e.querySelector("#".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=t.validationMessage,r.classList.add(o.errorClass)}(e,t,o)}(e,n,t),function(e,t,o){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(o.inactiveButtonClass),t.disabled=!1):(t.classList.add(o.inactiveButtonClass),t.disabled=!0)}(o,r,t)}))}))}(e,P)}))})();